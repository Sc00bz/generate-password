# Generate Password
Generate random passwords with a CSPRNG, uniform distribution, and less footguns.

## Usage
It is highly suggested that you use `genPassword()` with default flags. If you are required to have uppercase and/or symbols by the password policy then add the appropriate flags: `GEN_PASSWORD_FLAG_NEED_UPPERCASE` and/or `GEN_PASSWORD_FLAG_NEED_SYMBOL`. They are superficial to make it easy to type in on a phone's password keyboard.

### General example

```
uint32_t desiredBitStrength = 80;
char     password[38];

if (genPassword(password, desiredBitStrength))
{
	printf("Bad settings\n");
}
else
{
	uint32_t baseLength        = genPassword_getBaseLength(desiredBitStrength);
	double   actualBitStrength = genPassword_getBitStrength(baseLength);	

	printf("Desired bit strength: %u\n", desiredBitStrength);
	printf("Actual bit strength:  %f\n", actualBitStrength);
	printf("Base password Length: %u\n", baseLength);
	printf("Password generated:   %s\n", password);
}
```



### genPassword()

```
int genPassword(char password[38], uint32_t bitStrength, int flags = 0);
```

Generates a random password using a CSPRNG given a desired bit strength of at most 128 bits. The passwords that are generated are lowercase numeric with `floor(length*10.125/36)` digits, `(length-digits-1)` letters, and one more letter or digit. Digits are noncontiguous and no repeated characters. There are 8 targets: 48, 56, 64, 72, 80, 96, 100, and 128. Actual strengths are slightly higher: 48.7441, 58.1764, 67.2404, 76.1313, 80.4366, 96.9324, 100.8567, and 128.0527. `password` is the password buffer and should be at least 38 characters in length. `bitStrength` is the desired bit strength of the password. `bitStrength` can be set to any value 128 or less and it will select the correct target. It is suggested you stick with the original 8 target bit strengths and display them as such (ie 56 or 56+ vs 58 or 58.1764). `flags` is for the flags for uppercase (`GEN_PASSWORD_FLAG_NEED_UPPERCASE`) and/or symbol (`GEN_PASSWORD_FLAG_NEED_SYMBOL`). This returns zero on success, otherwise non-zero. If there is a problem with the CSPRNG it will `exit(1)`.

#### Example

```
char password[38];
if (genPassword(password, 80))
{
	printf("Bad settings\n");
}
else
{
	printf("Password generated: %s\n", password);
}
```

### genPasswordLength()

```
int genPasswordLength(char password[38], uint32_t baseLength, int flags = 0);
```

Generates a random password using a CSPRNG given a desired **base** password length of at most 36 characters. The passwords that are generated are lowercase numeric with `floor(length*10.125/36)` digits, `(length-digits-1)` letters, and one more letter or digit. Digits are noncontiguous and no repeated characters.

`baseLength` | Bit strength
-- | --
8 | 39.1201
9 | 43.9961
10 | 48.7441
11 | 53.4676
12 | 58.1764
13 | 62.7665
14 | 67.2404
15 | 71.7042
16 | 76.1313
17 | 80.4366
18 | 84.6201
19 | 88.8587
20 | 92.9647
21 | 96.9324
22 | 100.8567
23 | 104.7212
24 | 108.4265
25 | 111.9709
26 | 115.5350
27 | 118.9071
28 | 122.0659
29 | 125.1295
30 | 128.0527
31 | 130.6870
32 | 132.9848
33 | 135.2219
34 | 136.9874
35 | 138.0943
36 | 138.0943

`password` is the password buffer of at least (`baseLength`+2) characters (or use `char[38]` as that's the max). `baseLength` is the length of base password (8 to 36). `flags` is for the flags for uppercase (`GEN_PASSWORD_FLAG_NEED_UPPERCASE`) and/or symbol (`GEN_PASSWORD_FLAG_NEED_SYMBOL`). This returns zero on success, otherwise non-zero. If there is a problem with the CSPRNG it will `exit(1)`.

#### Example

```
char password[17 + 2];
if (genPasswordLength(password, 17))
{
	printf("Bad settings\n");
}
else
{
	printf("Password: \"%s\"\n", password);
}
```

### genPassword_getBitStrength()

```
double genPassword_getBitStrength(uint32_t baseLength);
```

Gets the bit strength of a password generated by genPassword() and genPasswordLength(). `baseLength` is the length of base password. Returns the bit strength on success, otherwise zero.

#### Example

```
uint32_t baseLength  = 17;
double   bitStrength = genPassword_getBitStrength(baseLength);
if (bitStrength == 0)
{
	printf("%u is an invalid bit base password length.\n", baseLength);
}
else
{
	printf("genPasswordLength(password, %u) has a bit strength of %f\n", baseLength, bitStrength);
}
```

### genPassword_getBaseLength()

```
uint32_t genPassword_getBaseLength(uint32_t bitStrength);
```

Gets the base password length given a desired bit strength of at most 128 bits. There are 8 targets: 48, 56, 64, 72, 80, 96, 100, and 128. Actual strengths are slightly higher: 48.7441, 58.1764, 67.2404, 76.1313, 80.4366, 96.9324, 100.8567, and 128.0527. `bitStrength` can be set to any value 128 or less and it will select the correct target. It is suggested you stick with the original 8 target bit strengths and display them as such (ie 56 or 56+ vs 58 or 58.1764). `bitStrength` is the desired bit strength of the password. Returns the base password length on success, otherwise zero.

#### Example

```
uint32_t bitStrength = 80;
uint32_t baseLength  = genPassword_getBaseLength(bitStrength);
if (baseLength == 0) 
{
	printf("%u is an invalid bit strength.\n", bitStrength);
}
else
{
	printf("genPassword(password, %u) has a base password length of %u\n", bitStrength, baseLength);
}
```

## CSPRNG

CSPRNG is from [@Sc00bz/ModRandom/csprng-cpp](https://github.com/Sc00bz/ModRandom/tree/master/csprng-cpp). I was going to symlink to this code, but Git doesn't let you just link a folder or a file from another project. Then I found out that if you link to a repo ("submodule" thing), when you download a zip of the project from GitHub it's just an empty folder.
